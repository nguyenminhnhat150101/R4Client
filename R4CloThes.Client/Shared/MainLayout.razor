@inherits LayoutComponentBase
@inject ILocalStorageService localStorage
@inject NavigationManager nav
@using R4CloThes.Client.Models.ViewModel
@inject ICartService cartService
@implements IDisposable

<div class="page">
    <div class="search-wrapper section-padding-100">
        <div class="search-close">
            <i class="fa fa-close" aria-hidden="true"></i>
        </div>
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <div class="search-content">
                        <form action="#" method="get">
                            <input type="search" name="search" id="search" placeholder="Type your keyword...">
                            <button type="submit"><img src="template/img/core-img/search.png" alt=""></button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Search Wrapper Area End -->
    <!-- ##### Main Content Wrapper Start ##### -->
    <div class="main-content-wrapper d-flex clearfix">
        <div class="mobile-nav">
            <!-- Navbar Brand -->
            <div class="amado-navbar-brand">
                <a href="/" style="font-size:14px">R4 Clothes</a>
            </div>
            <!-- Navbar Toggler -->
            <div class="amado-navbar-toggler">
                <span></span><span></span><span></span>
            </div>
        </div>
        <!-- Header Area Start -->
        <div class="col-3">
            <header class="header-area clearfix">
                <!-- Close Icon -->
                <div class="nav-close">
                    <i class="fa fa-close" aria-hidden="true"></i>
                </div>
                <!-- Logo -->
                <div class="logo">
                    <a href="/"><img src="logo_r4.png" alt=""></a>
                </div>
                <!-- Amado Nav -->
                <nav class="amado-nav">
                    <ul>
                        <MudNavLink Href="/" Icon="@Icons.Filled.Home" IconColor="Color.Warning">Trang Chủ</MudNavLink>
                        <MudNavLink Href="/sanpham" class="active" Icon="@Icons.Rounded.FormatListBulleted" IconColor="Color.Warning">Sản Phẩm</MudNavLink>
                        <MudNavLink Href="/About" class="active" Icon="@Icons.Filled.People" IconColor="Color.Warning">Giới Thiệu</MudNavLink>
                        @if (token != null)
                        {
                            <MudNavLink Href="/donhang" class="active" Icon="@Icons.Filled.Check" IconColor="Color.Warning">Đơn Hàng</MudNavLink>
                            <MudNavLink Href="/thongtin" class="active" Icon="@Icons.Filled.People" IconColor="Color.Warning">Thông Tin Khách Hàng</MudNavLink>
                            <MudNavLink Href="/doimk" Icon="@Icons.Filled.LockOpen" IconColor="Color.Warning">Đổi mật khẩu</MudNavLink>
                            <MudNavLink Href="/logout" Icon="@Icons.Filled.Block" IconColor="Color.Warning">Đăng xuất</MudNavLink>
                        }
                        @if (token == null)
                        {
                            <MudNavGroup Title="Đăng nhập" Icon="@Icons.Filled.AccountCircle" Expanded="true">
                                <MudNavLink Href="/login" Icon="@Icons.Rounded.SupervisedUserCircle" IconColor="Color.Warning">Đăng Nhập</MudNavLink>
                                <MudNavLink Href="/Dangky" Icon="@Icons.Filled.LockOutline" IconColor="Color.Warning">Đăng Ký</MudNavLink>
                                <MudNavLink Href="/quenmk" Icon="@Icons.Filled.ScreenLockRotation" IconColor="Color.Warning">Quên mật khẩu</MudNavLink>

                            </MudNavGroup>
                        }
                        <MudNavLink Href="/cart" Icon="@Icons.Filled.ShoppingCart" IconColor="Color.Warning">Giỏ hàng<span>(@count)</span></MudNavLink>
                    </ul>
                </nav>
                <!-- Social Button -->
                
            </header>
        </div>
        <!-- Header Area End -->
        <!-- index -->
        @Body

        <!-- index End -->
    </div>

    <!-- ##### Main Content Wrapper End ##### -->
    <!-- ##### Newsletter Area Start ##### -->
    <section class="newsletter-area section-padding-100-0">
        <div class="container">
            <div class="row align-items-center">
                <!-- Newsletter Text -->
                <div class="col-12 col-lg-6 col-xl-7">
                    <div class="newsletter-text mb-100">
                        <p>Shop R4-CloThes </p>
                    </div>
                </div>
                <!-- Newsletter Form -->
                <div class="col-12 col-lg-6 col-xl-5">
                    <div class="newsletter-form mb-100">
                        <form action="#" method="post">
                            <input type="email" name="email" class="nl-email" placeholder="Your E-mail">
                            <input type="submit" value="Subscribe">
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- ##### Newsletter Area End ##### -->
    <!-- ##### Footer Area Start ##### -->
    <footer class="footer_area clearfix">
        <div class="container">
            <div class="row align-items-center">
                <!-- Single Widget Area -->
                <div class="col-12 col-lg-4">
                    <div class="single_widget_area">
                        <!-- Logo -->
                        <div class="footer-logo mr-50">
                            <a href="index.html"><img src="template/img/core-img/logo2.png" alt=""></a>
                        </div>
                        <!-- Copywrite Text -->
                    </div>
                </div>
                <!-- Single Widget Area -->
                <div class="col-12 col-lg-8">
                    <div class="single_widget_area">
                        <!-- Footer Menu -->
                        <div class="footer_menu">
                            <nav class="navbar navbar-expand-lg justify-content-end">
                                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#footerNavContent" aria-controls="footerNavContent" aria-expanded="false" aria-label="Toggle navigation"><i class="fa fa-bars"></i></button>
                                <div class="collapse navbar-collapse" id="footerNavContent">
                                    <div class="container text-center text-md-start mt-5">
                                        <!-- Grid row -->
                                        <div class="row mt-3">
                                            <!-- Grid column -->
                                            <div class="col-md-3 col-lg-4 col-xl-3 mx-auto mb-4">
                                                <!-- Content -->
                                                <h6 class="text-light fw-bold">Giới Thiệu</h6>
                                                <hr class="mb-4 mt-0 d-inline-block mx-auto"
                                                    style="width: 60px; background-color: mediumspringgreen; height: 2px" />
                                                <p class="text-light">
                                                    Thời trang là một sân chơi cho đến một độ tuổi nhất định. Nhưng sau đó bạn phải tìm ra chữ ký của riêng bạn và phong cách của riêng bạn
                                                </p>
                                            </div>
                                            <!-- Grid column -->
                                            <!-- Grid column -->
                                            <div class="col-md-2 col-lg-2 col-xl-2 mx-auto mb-4">
                                                <!-- Links -->
                                                <h6 class="text-light fw-bold">Products</h6>
                                                <hr class="mb-4 mt-0 d-inline-block mx-auto"
                                                    style="width: 60px; background-color: mediumspringgreen; height: 2px" />
                                                <p>
                                                    <a href="#!" class="text-light">Sản phẩm </a>
                                                </p>
                                                <p>
                                                    <a href="#!" class="text-light">Giỏ hàng </a>
                                                </p>
                                                <p>
                                                    <a href="#!" class="text-light">Hóa Đơn</a>
                                                </p>

                                            </div>
                                            <!-- Grid column -->
                                            <!-- Grid column -->
                                            <div class="col-md-3 col-lg-2 col-xl-2 mx-auto mb-4">
                                                <!-- Links -->
                                                <h6 class="text-light fw-bold">Useful links</h6>
                                                <hr class="mb-4 mt-0 d-inline-block mx-auto"
                                                    style="width: 60px; background-color: mediumspringgreen; height: 2px" />
                                                <p>
                                                    <a href="#!" class="text-light">Tài khoản</a>
                                                </p>
                                                <p>
                                                    <a href="#!" class="text-light">Đổi mật khẩu </a>
                                                </p>

                                            </div>
                                            <!-- Grid column -->
                                            <!-- Grid column -->
                                            <div class="col-md-4 col-lg-3 col-xl-3 mx-auto mb-md-0 mb-4 ">
                                                <!-- Links -->
                                                <h6 class="text-light fw-bold">Contact</h6>
                                                <hr class="mb-4 mt-0 d-inline-block mx-auto"
                                                    style="width: 60px; background-color: mediumspringgreen; height: 2px" />
                                                <p class="text-light"> Công Viên Phần Mềm Quang Trung, Quận 12,Tp HCM</p>
                                                <p class="text-light">R4Clothes@gmail.com</p>
                                                <p class="text-light">0989898985</p>

                                            </div>
                                            <!-- Grid column -->
                                        </div>
                                        <!-- Grid row -->
                                    </div>
                                </div>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </footer>
</div>
<MudThemeProvider />
<MudDialogProvider FullWidth="true" 
                   MaxWidth="MaxWidth.ExtraSmall" 
                   CloseButton="true" 
                   DisableBackdropClick="true" 
                   NoHeader="true" 
                   Position="DialogPosition.Center" />
<MudSnackbarProvider />
@code{
    public int count = 0;
    public string token = null;

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        List<SanPhamGioHang> cart = await localStorage.GetItemAsync<List<SanPhamGioHang>>("cart");
        count = cart != null ? cart.Count : 0;
        token = await localStorage.GetItemAsync<string>("token");

        StateHasChanged();
    }

    protected override void OnInitialized()
    {
        cartService.OnChange += StateHasChanged;

    }
    public void Dispose()
    {
        cartService.OnChange -= StateHasChanged;

    }

}